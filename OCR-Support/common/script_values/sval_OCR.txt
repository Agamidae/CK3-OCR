army_size_sval = {
	value = army_size
}

army_max_size_sval = {
	value = army_max_size
}

total_army_siege_svalue = {
	value = total_army_siege_value
}

total_tax = {
	every_county_province = {
		add = monthly_income
	}
}

total_levies = {
	every_county_province = {
		add = building_levies
	}
}

my_counties = {
	every_sub_realm_county = {
		add = 1
	}
}

num_artifacts = {
	every_character_artifact = {
		add = 1
	}
}

num_artifacts_claims = {
	every_claimed_artifact = {
		add = 1
	}
}

ocr_attacker_war_score = {
	value = attacker_war_score
}

ocr_defender_war_score = {
	value = defender_war_score
}

realm_holdings = {
	every_realm_province = {
		add = 1
	}
}

vassal_holdings = {
	value = realm_holdings
	every_directly_owned_province = {
		limit = {
			barony = {
				is_leased_out = no
			}
		}
		subtract = 1
	}
}

vassal_counties = {
	every_sub_realm_county = {
		limit = {
			NOT = {
				holder = root
			}
		}
		add = 1
	}
}

ransom_cost_situation = {
	value = ransom_cost_value
}

current_char_gold = {
	value = 0
	if = {
		limit = { is_ruler = yes }
		add = gold
	}
	else_if = {
		limit = { exists = liege }
		add = liege.gold
	}
}

prestige_cost_call_ally = {
	value = 0

	if = {
		limit = { highest_held_title_tier = 2 }
		add = minor_prestige_value
	}
	else_if = {
		limit = { highest_held_title_tier = 3 }
		add = medium_prestige_value
	}
	else_if = {
		limit = { highest_held_title_tier = 4 }
		add = major_prestige_value
	}
	else_if = {
		limit = { highest_held_title_tier = 5 }
		add = massive_prestige_value
	}
}

num_of_wars = {
	every_character_war = {
		add = 1
	}
}

num_of_primary_enemies = {
	every_primary_war_enemy = {
		add = 1
	}
}

num_of_allies = {
	every_ally = {
		add = 1
	}
}

num_of_truces = {
	every_truce_target = {
		add = 1
	}
}

num_of_raids = {
	every_hostile_raider = {
		add = 1
	}
	every_raid_target = {
		add = 1
	}
}

de_jure_penalty = {
	value = 1

	if = {
		limit = {
			highest_held_title_tier = tier_county
			primary_title = {
				duchy = {
					# is_title_created = no
					NOT = {
						holder = root.liege
					}
				}
			}
		}
		add = -0.5
		if = {
			limit = {
				primary_title = {
					any_this_title_or_de_jure_above = {
						holder = root.liege
					}
				}
			}
			add = 0.25
		}
	}

	else_if = {
		limit = {
			highest_held_title_tier = tier_duchy
		}
		if = {
			limit = {
				primary_title = {
					is_titular = yes
				}
			}
			add = -0.5
		}
		else_if = {
			limit = {
				primary_title = {
					kingdom = {
						# is_title_created = no
						NOT = {
							holder = root.liege
						}
						empire = {
							NOT = {
								holder = root.liege
							}
						}
					}
				}
			}
			add = -0.5
		}
	}
	else_if = {
		limit = {
			highest_held_title_tier = tier_kingdom
		}
		if = {
			limit = {
				primary_title = {
					is_titular = yes
				}
			}
			add = -0.5
		}
		else_if = {
			limit = {
				primary_title = {
					empire = {
						NOT = {
							holder = root.liege
						}
					}
				}
			}
			add = -0.5
		}
	}

}

county_opinion_val = {
	value = county_opinion
}

num_buildings_sval = {
	value = num_buildings
	add = -1
	min = 0
}

num_buildings_sval_special = {
	value = num_buildings
	add = -1
	if = {
		limit = {
			has_special_building = yes
		}
		add = 1
	}
	min = 0
}

num_building_slots = {
	value = building_slots
	subtract = 1
}

free_building_slots_sval = {
	value = free_building_slots
	if = {
		limit = {
			has_holding = no
		}
		add = -1
	}
}

faith_rulers = {
	value = 0

	every_faith_ruler = {
		add = 1
	}
}

faith_followers = {
	value = 0

	every_faith_character = {
		add = 1
	}
	every_faith_ruler = {
		add = -1
	}
}

artifact_rarity_svalue = {
	value = 0

	if = {
		limit = {
			rarity = masterwork
		}
		add = 1
	}

	else_if = {
		limit = {
			rarity = famed
		}
		add = 2
	}

	else_if = {
		limit = {
			rarity = illustrious
		}
		add = 3
	}
	if = {
		limit = { is_unique = yes }
		add = 0.5
	}
}

total_war_participants = {
	value = primary_attacker.current_military_strength
	add = primary_defender.current_military_strength
}

attacker_war_score_sval = {
	value = attacker_war_score
}

war_days_sval = {
	value = war_days
}

total_war_attackers = {
	value = 0

	every_war_attacker = {
		add = current_military_strength
	}
}

total_war_defenders = {
	value = 0

	every_war_defender = {
		add = current_military_strength
	}
}

vassal_wars = {
	every_vassal_or_below = {
		limit = {
			is_at_war = yes
		}
		every_character_war = {
			limit = {
				NOT = { is_in_list = wars }
				add_to_temporary_list = wars
			}
			add = 1
		}
	}
}

realm_wars = {
	every_ruler = {
		limit = {
			is_at_war = yes
		}
		every_character_war = {
			limit = {
				NOT = { is_in_list = wars }
				any_war_participant = {
					top_liege = root.top_liege
				}
				add_to_temporary_list = wars
			}
			add = 1
		}
	}
}

holy_wars = {
	every_ruler = {
		limit = {
			is_at_war = yes
		}
		every_character_war = {
			limit = {
				NOT = { is_in_list = wars }
				OR = {
					using_cb = minor_religious_war
					using_cb = religious_war
					using_cb = major_religious_war
					using_cb = excommunication_war
					using_cb = flowery_war_cb
					using_cb = undirected_great_holy_war
					using_cb = directed_great_holy_war
				}
				add_to_temporary_list = wars
			}
			add = 1
		}
	}
}

great_holy_wars = {
	every_ruler = {
		limit = {
			is_at_war = yes
		}
		every_character_war = {
			limit = {
				NOT = { is_in_list = wars }
				OR = {
					using_cb = undirected_great_holy_war
					using_cb = directed_great_holy_war
				}
				add_to_temporary_list = wars
			}
			add = 1
		}
	}
}


civil_wars = {
	every_ruler = {
		limit = {
			is_at_war = yes
		}
		every_character_war = {
			limit = {
				NOT = { is_in_list = wars }
				OR = {
					using_cb = independence_faction_war
					using_cb = liberty_faction_war
					using_cb = populist_war
					using_cb = claimant_faction_war
					using_cb = depose_war
					using_cb = refused_liege_demand_war
					using_cb = independence_war
					using_cb = nation_fracturing_faction_war
				}
				add_to_temporary_list = wars
			}
			add = 1
		}
	}
}


test_value = {
	if = {
		limit = { debug_only = yes }
		value = 1
	}
	else = {
		value = 2
	}
	# save_temporary_scope_value_as = me
	# if = {
	# 	limit = { scope:me = 1 }
	# 	add = 3
	# }
}

building_levies_sval = {
	value = building_levies
}


current_military_strength_sval = {
	value = current_military_strength
}

holding_order = {
	value = 0
	if = {
		limit = {
			is_county_capital = yes
		}
		add = 10
	}
	if = {
		limit = {
			exists = province_owner
			province_owner = scope:this_county.holder
		}
		add = 10
	}
	if = {
		limit = {
			has_holding = no
		}
		subtract = 20
	}
	else_if = {
		limit = {
			has_holding_type = castle_holding
		}
		add = 10
	}
	else_if = {
		limit = {
			has_holding_type = city_holding
		}
		add = 8
	}
	else_if = {
		limit = {
			has_holding_type = church_holding
		}
		add = 7
	}
	else = {
	}
}

all_playable_rulers = {
	every_independent_ruler = {
		limit = {
			sub_realm_size > 0
			exists = capital_province
			NOR = {
				has_government = theocracy_government
				has_government = republic_government
				has_government = mercenary_government
				has_government = holy_order_government
			}
		}
		add = 1
	}
}

all_landed_rulers = {
	every_independent_ruler = {
		limit = {
			sub_realm_size > 0
			exists = capital_province
			# NOR = {
			# 	has_government = theocracy_government
			# 	has_government = republic_government
			# 	has_government = mercenary_government
			# 	has_government = holy_order_government
			# }
		}
		add = 1
	}
}

playable_vassals = {
	every_vassal = {
		limit = {
			sub_realm_size > 0
			exists = capital_province
			NOR = {
				has_government = theocracy_government
				has_government = republic_government
				has_government = mercenary_government
				has_government = holy_order_government
			}
		}
		add = 1
	}
}

counties_in_title = {
	every_in_de_jure_hierarchy = {
		limit = {
			tier = tier_county
		}
		add = 1
	}
}

your_counties_in_title = {
	every_in_de_jure_hierarchy = {
		limit = {
			tier = tier_county
			holder = {
				OR = {
					this = scope:player
					any_liege_or_above = {
						this = scope:player
					}
				}
			}
		}
		add = 1
	}
}

height_value = {
	# if = {
	# 	limit = {
	# 		morph_gene_value = {
	# 			category = body_height
	# 			value = 1
	# 		}
	# 	}
	# 	add = 1
	# }
}

age_height = {
	value = 1
	subtract = {
		value = 17
		subtract = age
		multiply = 0.035
	}
	max = 1
}

sex_height = {
	if = {
		limit = {
			is_female = yes
		}
		value = 161
	}
	else = {
		value = 175
	}
	if = {
		limit = {
			has_trait = dwarf
		}
		multiply = 0.75
	}
	if = {
		limit = {
			has_trait = giant
		}
		multiply = 1.21
	}
	multiply = 0.99
	multiply = age_height
}

height_feet = {
	value = sex_height
	divide = 30.48
}

hostiles_inside = {
	if = {
		limit = {
			has_variable_list = hostiles_inside
		}
		every_in_list = {
			variable = hostiles_inside
			if = {
				limit = {
					exists = var:army_strength
				}
				add = var:army_strength
			}
			else = {
				add = army_size
			}
		}
	}
	divide = 100
	floor = yes
	multiply = 100
}

hostiles_inside_liege = {
	if = {
		limit = {
			has_variable_list = hostiles_inside_liege
		}
		every_in_list = {
			variable = hostiles_inside_liege
			if = {
				limit = {
					exists = var:army_strength
				}
				add = var:army_strength
			}
			else = {
				add = army_size
			}
		}
	}
	divide = 100
	floor = yes
	multiply = 100
}

hostiles_outside = {
	if = {
		limit = {
			has_variable_list = hostiles_outside
		}
		every_in_list = {
			variable = hostiles_outside
			if = {
				limit = {
					exists = var:army_strength
				}
				add = var:army_strength
			}
			else = {
				add = army_size
			}
		}
	}
	divide = 100
	floor = yes
	multiply = 100
}

test_sval = {
	value = 10
}

neighbours_sval = {
	every_in_list = {
		variable = adjacent_rulers
		add = 1
	}
	every_in_list = {
		variable = adjacent_vassals
		add = 1
	}
	every_in_list = {
		variable = adjacent_rulers_across_water
		add = 1
	}
}

unmarried_children = {
	every_child = {
		limit = {
			NOR = {
				is_married = yes
				is_betrothed = yes
			}
		}
		add = 1
	}
}

knights_sval = {
	value = number_of_knights
}

knights_max_sval = {
	value = max_number_of_knights
}

chaplain_gold = {
	value = cp:councillor_court_chaplain.gold
}

development_rate_sval = {
	value = development_rate
}

county_control_rate_sval = {
	value = county_control_rate
}

active_tasks = {
	if = {
		limit = {
			exists = cp:councillor_court_chaplain
			cp:councillor_court_chaplain = {
				save_temporary_scope_as = councillor
			}
			OR = {
				council_task_is_shown = { task = task_fabricate_claim }
				council_task_is_shown = { task = task_conversion }
			}
		}
		add = 1
	}

	if = {
		limit = {
			exists = cp:councillor_chancellor
			cp:councillor_chancellor = {
				save_temporary_scope_as = councillor
			}
			OR = {
				council_task_is_shown = { task = task_integrate_title }
				court_task_is_shown = { task = task_bestow_royal_favor }
			}
		}
		add = 1
	}

	if = {
		limit = {
			exists = cp:councillor_marshal
			cp:councillor_marshal = {
				save_temporary_scope_as = councillor
			}
			council_task_is_shown = { task = task_increase_control }
		}
		add = 1
	}

	if = {
		limit = {
			exists = cp:councillor_steward
			cp:councillor_steward = {
				save_temporary_scope_as = councillor
			}
			OR = {
				council_task_is_shown = { task = task_develop_county }
				council_task_is_shown = { task = task_promote_culture }
				council_task_is_shown = { task = task_accept_culture }
				council_task_is_shown = { task = task_convince_dejure }
			}
		}
		add = 1
	}

	if = {
		limit = {
			exists = cp:councillor_spymaster
			cp:councillor_spymaster = {
				save_temporary_scope_as = councillor
			}
			court_task_is_shown = { task = task_find_secrets }
		}
		add = 1
	}
}


build_farms = {
	every_sub_realm_barony = {
		limit = {
			can_build_farms = yes
		}
		add = 1
	}
}

integrate_titles = {
	# every_sub_realm_county = {
	# 	limit = {
	# 		can_integrate_title = yes
	# 	}
	# 	add = 1
	# }
}

num_of_living_children = {
	every_child = {
		limit = {
			is_alive = yes
		}
		add = 1
	}
}

num_of_dead_children = {
	every_child = {
		limit = {
			is_alive = no
		}
		add = 1
	}
}

low_control_counties = {
	every_sub_realm_county = {
		limit = {
			can_increase_control = yes
			trigger_if = {
				limit = {
					root = { NOT = { exists = var:build_in_vassals } }
				}
				holder = root
			}
		}
		add = 1
	}
}

armies_total = {
	# every_in_list = {
	# 	variable = hostiles_inside
	# 	add = 1
	# }
	# every_in_list = {
	# 	variable = hostiles_outside
	# 	add = 1
	# }
	# every_in_list = {
	# 	variable = hostiles_inside_liege
	# 	add = 1
	# }
	# every_in_list = {
	# 	variable = in_the_fog
	# 	add = 1
	# }
	every_in_list = {
		variable = all_enemies
		add = 1
	}
	every_in_list = {
		variable = your_armies
		add = 1
	}
	every_in_list = {
		variable = allied_units
		add = 1
	}
	subtract = 1
}

allies_total = {
	every_in_list = {
		variable = all_allies
		add = army_size
	}
	divide = 100
	floor = yes
	multiply = 100
}

enemies_total = {
	every_in_list = {
		variable = all_enemies
		add = army_size
		# variable?
	}
	divide = 100
	floor = yes
	multiply = 100
}

enemies_total_nearby = {
	scope:county = {
		every_county_province = {
			every_army_in_location = {
				limit = {
					army_owner = {
						is_hostile_to_me = yes
					}
				}
				add = army_size
			}
		}
		every_neighboring_county = {
			every_county_province = {
				every_army_in_location = {
					limit = {
						army_owner = {
							is_hostile_to_me = yes
						}
					}
					add = army_size
				}
			}
		}
	}
	divide = 100
	floor = yes
	multiply = 100
}

enemies_total_nearby_sea = {
	army_owner = {
		every_in_list = {
			variable = all_enemies
			limit = {
				location = {
					trigger_if = {
						limit = {
							is_sea_province = no
						}
						county = {
							is_coastal_county = yes
						}
					}
					squared_distance = {
						target = root.location
						value < 10000
					}
				}
			}
			add = army_size
		}
	}
	divide = 100
	floor = yes
	multiply = 100
}

enemies_total_nearby_combat = {
	scope:province = {
		county = {
			save_temporary_scope_as = county

			every_county_province = {
				limit = {
					NOT = {
						this = scope:province
					}
				}
				every_army_in_location = {
					limit = {
						army_owner = {
							is_hostile_to_me = yes
						}
					}
					add = army_size
				}
			}
			every_neighboring_county = {
				every_county_province = {
					every_army_in_location = {
						limit = {
							army_owner = {
								is_hostile_to_me = yes
							}
						}
						add = army_size
					}
				}
			}
		}
	}
	divide = 100
	floor = yes
	multiply = 100
}

allies_total_nearby = {
	scope:county = {
		every_county_province = {
			every_army_in_location = {
				limit = {
					NOT = {
						this = scope:army
					}
					army_owner = {
						is_friendly_to_me = yes
					}
				}
				add = army_size
			}
		}
		every_neighboring_county = {
			every_county_province = {
				every_army_in_location = {
					limit = {
						NOT = {
							this = scope:army
						}
						army_owner = {
							is_friendly_to_me = yes
						}
					}
					add = army_size
				}
			}
		}
	}
	divide = 100
	floor = yes
	multiply = 100
}

allies_total_nearby_combat = {
	scope:province = {
		county = {
			save_temporary_scope_as = county
			every_county_province = {
				limit = {
					NOT = {
						this = scope:province
					}
				}
				every_army_in_location = {
					limit = {
						army_owner = {
							is_friendly_to_me = yes
						}
					}
					add = army_size
				}
			}
			every_neighboring_county = {
				every_county_province = {
					every_army_in_location = {
						limit = {
							army_owner = {
								is_friendly_to_me = yes
							}
						}
						add = army_size
					}
				}
			}
		}
	}
	divide = 100
	floor = yes
	multiply = 100
}

allies_total_nearby_sea = {
	army_owner = {
		every_in_list = {
			variable = all_allies
			limit = {
				location = {
					trigger_if = {
						limit = {
							is_sea_province = no
						}
						county = {
							is_coastal_county = yes
						}
					}
					squared_distance = {
						target = root.location
						value < 10000
					}
				}
			}
			# if = {
			# 	limit = {
			# 		has_variable = army_strength
			# 	}
			# 	add = var:army_strength
			# }
			add = army_size
		}
	}
	divide = 100
	floor = yes
	multiply = 100
}

hostile_counties_total = {
	every_in_list = {
		variable = hostile_forts
		add = 1
	}
	every_in_list = {
		variable = war_targets
		add = 1
	}
	every_in_list = {
		variable = your_hostile_forts
		add = 1
	}
	every_in_list = {
		variable = hostile_war_targets
		add = 1
	}
}

enemies_in_the_county = {
	scope:province = {
		county = {
			every_county_province = {
				every_army_in_location = {
					limit = {
						army_owner = {
							is_hostile_to_me = yes
						}
					}
					add = army_size
				}
			}
		}
	}
	divide = 100
	floor = yes
	multiply = 100
}

potential_enemies_in_the_province = {
	scope:province = {
		every_army_in_location = {
			limit = {
				army_owner = {
					top_liege = {
						this = scope:province.county.holder.top_liege
					}
				}
			}
			add = army_size
		}
	}
	divide = 100
	floor = yes
	multiply = 100
}

enemies_in_the_province = {
	scope:province = {
		every_army_in_location = {
			limit = {
				army_owner = {
					is_hostile_to_me = yes
				}
			}
			add = army_size
		}
	}
	divide = 100
	floor = yes
	multiply = 100
}

allies_in_the_province = {
	scope:province = {
		every_army_in_location = {
			limit = {
				army_owner = {
					is_friendly_to_me = yes
				}
			}
			add = army_size
		}
	}
	divide = 100
	floor = yes
	multiply = 100
}

allies_in_the_county = {
	scope:province = {
		county = {
			every_county_province = {
				every_army_in_location = {
					limit = {
						army_owner = {
							is_friendly_to_me = yes
						}
					}
					add = army_size
				}
			}
		}
	}
	divide = 100
	floor = yes
	multiply = 100
}

allies_in_the_province_not_me = {
	scope:province = {
		every_army_in_location = {
			limit = {
				army_owner = {
					NOT = {
						this = root
					}
					is_friendly_to_me = yes
				}
			}
			add = army_size
		}
	}
	divide = 100
	floor = yes
	multiply = 100
}

num_of_forts_in_county = {
	every_county_province = {
		limit = {
			fort_level > 0
		}
		add = 1
	}
}

num_of_adjacent_counties = {
	every_in_list = {
		variable = adjacent_counties
		add = 1
	}
}
num_of_hostile_adjacent_counties = {
	scope:county = {
		every_in_list = {
			variable = adjacent_counties
			limit = {
				county_controller = {
					is_county_safe = no
				}
			}
			add = 1
		}
	}
}

in_the_fog = {
	if = {
		limit = {
			has_variable_list = in_the_fog
		}
		every_in_list = {
			variable = in_the_fog
			add = army_size
		}
	}
	divide = 100
	floor = yes
	multiply = 100
}

supply_limit = {
	value = 2000

	add = {
		value = county.development_level
		multiply =  150
	}

	multiply = {
		value = 1

		if = {
			limit = {
				is_coastal = yes
			}
			add = 0.25
		}

		if = {
			limit = {
				terrain = farmlands
			}
			add = 0.5
		}
		else_if = {
			limit = {
				terrain = hills
			}
			add = -0.1
		}
		else_if = {
		    limit = {
		        terrain = mountains
		    }
		    add = -0.5
		}
		else_if = {
		    limit = {
		        terrain = desert
		    }
		    add = -0.3
		}
		else_if = {
		    limit = {
		        terrain = desert_mountains
		    }
		    add = -0.6
		}
		else_if = {
		    limit = {
		        terrain = oasis
		    }
		    add = 0.1
		}
		else_if = {
		    limit = {
		        terrain = jungle
		    }
		    add = -0.25
		}
		else_if = {
		    limit = {
		        terrain = forest
		    }
		    add = -0.1
		}
		else_if = {
		    limit = {
		        terrain = taiga
		    }
		    add = -0.2
		}
		else_if = {
		    limit = {
		        terrain = wetlands
		    }
		    add = -0.25
		}
		else_if = {
		    limit = {
		        terrain = floodplains
		    }
		    add = 0.35
		}
		if = {
			limit = {
				county = {
					holder = {
						OR = {
							any_liege_or_above = {
								this = scope:player
							}
							this = scope:player
						}
					}
				}
			}
			add = 0.3
		}
		else_if = {
			limit = {
				scope:player = {
					is_independent_ruler = no
				}
				county = {
					holder = {
						OR = {
							is_liege_or_above_of = scope:player
							any_liege_or_above = {
								is_liege_or_above_of = scope:player
							}
						}
					}
				}
			}
			add = 0.15
		}
		if = {
			limit = {
				county = {
					holder = {
						has_government = tribal_government
					}
				}
				scope:player = {
					NOT = {
						has_government = tribal_government
					}
				}
			}
			add = -0.5
		}
	}
	floor = yes
}

supply_limit_true = {
	value = supply_limit

	every_army_in_location = {
		subtract = army_size
	}
}

highest_supply = {
	ordered_county_province = {
		order_by = supply_limit_true
		max = 1

		add = supply_limit_true
	}
}

armies_present_here = {
	every_army_in_location = {
		add = army_size
	}
}

holdings_in_county = {
	every_county_province = {
		add = 1
	}
}

adjacent_counties = {
	every_neighboring_county = {
		add = 1
	}
}

num_of_guests = {
	every_foreign_court_guest = {
		add = 1
	}
	every_pool_guest = {
		add = 1
	}
}

hunt_province_reference_value_extra = {
	value = hunt_province_reference_value
	if = {
		limit = {
			save_temporary_scope_as = province
		}
	}

	scope:player = {
		### HOST
		# SKILLS
		add = {
			value = learning
			divide = 4
			ceiling = yes
			max = 10
			desc = learning_modifier
		}
		add = {
			value = martial
			divide = 8
			ceiling = yes
			max = 10
			desc = martial_modifier
		}
		add = {
			value = prowess
			divide = 4
			ceiling = yes
			max = 10
			desc = prowess_modifier
		}
		# TRAIT
		add = {
			value = 0
			if = {
				limit = { has_trait = lifestyle_hunter }
				add = 3
			}
			desc = hunt_success_chance.trait
		}
		if = { # Beastmaster
			limit = { has_character_modifier = ep2_beastmaster_modifier }
			add = {
				value = 5
				desc = hunt_success_chance.ep2_beastmaster_modifier
			}
		}
		# MASTER OF THE HUNT
		if = {
			limit = { exists = court_position:master_of_hunt_court_position }
			add = {
				value = 0
				court_position:master_of_hunt_court_position = {
					if = {
						limit = {
							aptitude = { court_position = master_of_hunt_court_position value <= 1 }
						}
						add = 3
					}
					else_if = {
						limit = {
							aptitude = { court_position = master_of_hunt_court_position value = 2 }
						}
						add = 6
					}
					else_if = {
						limit = {
							aptitude = { court_position = master_of_hunt_court_position value = 3 }
						}
						add = 9
					}
					else_if = {
						limit = {
							aptitude = { court_position = master_of_hunt_court_position value = 4 }
						}
						add = 12
					}
					else = { add = 15 }
				}
				desc = hunt_success_chance.master_of_hunt
			}
		}
	}

	add = {
		value = 0
		scope:player.culture ?= {
			if = { # Forests
				limit = {
					has_cultural_parameter = forest_hunt_success_chance
					root = {
						OR = {
							terrain = forest
							terrain = taiga
						}
					}
				}
				add = 5
			}
			if = { # Hills
				limit = {
					has_cultural_parameter = hills_hunt_success_chance
					root = { terrain = hills }
				}
				add = 5
			}
			if = { # Deserts
				limit = {
					has_cultural_parameter = desert_hunt_success_chance
					root = {
						OR = {
							terrain = desert
							terrain = oasis
						}
					}
				}
				add = 5
			}
			if = { # Steppes
				limit = {
					has_cultural_parameter = steppe_hunt_success_chance
					root = { terrain = steppe }
				}
				add = 5
			}
			if = { # Mountains
				limit = {
					has_cultural_parameter = mountains_hunt_success_chance
					root = {
						OR = {
							terrain = mountains
							terrain = desert_mountains
						}
					}
				}
				add = 5
			}
			if = { # Drylands
				limit = {
					has_cultural_parameter = drylands_hunt_success_chance
					root = {
						OR = {
							terrain = drylands
							terrain = desert
						}
					}
				}
				add = 5
			}
			if = { # Jungle
				limit = {
					has_cultural_parameter = jungle_hunt_success_chance
					root = { terrain = jungle }
				}
				add = 5
			}
			if = { # Wetlands
				limit = {
					has_cultural_parameter = wetlands_hunt_success_chance
					root = {
						OR = {
							terrain = wetlands
							terrain = floodplains
						}
					}
				}
				add = 5
			}
		}
		desc = hunt_success_chance.culture
	}
	# SIGHTINGS
	if = {
		# won't work with falconry and special animals
		limit = {
			OR = {
				scope:province.county = { has_county_modifier = hunt_sighting_standard_modifier }
				scope:province.county = { has_county_modifier = hunt_sighting_dangerous_modifier }
			}
		}
		add = {
			value = 20
			desc = sighting_ocr
		}
	}
}

adjacent_holdings = {
	every_neighboring_province = {
		limit = {
			OR = {
				has_holding = yes
				has_free_building_slot = yes
			}
		}
		add = 1
	}
}

adjacent_rivers = {
	every_neighboring_province = {
		limit = {
			is_river_province = yes
		}
		add = 1
	}
}

adjacent_seas = {
	every_neighboring_province = {
		limit = {
			is_sea_province = yes
		}
		add = 1
	}
}

army_embark_cost = {
	value = army_size
	divide = 100
	if = {
		limit = {
			army_owner = {
				culture = {
					has_innovation = innovation_longboats
				}
			}
		}
		multiply = 0.25
	}
	if = {
		limit = {
			army_owner = {
				culture = {
					has_innovation = innovation_african_canoes
				}
			}
		}
		multiply = 0.75
	}
	if = {
		limit = {
			army_owner = {
				culture = {
					has_cultural_tradition = tradition_seafaring
				}
			}
		}
		multiply = 0.75
	}
	army_owner = {
		if = {
			limit = {
				has_character_modifier = high_king_of_the_seas_fp1_modifier
			}
			multiply = 0.5
		}
		if = {
			limit = {
				has_character_modifier = high_queen_of_the_seas_fp1_modifier
			}
			multiply = 0.5
		}
		if = {
			limit = {
				has_character_modifier = scandinavian_adventurer_fp1_modifier
			}
			multiply = 0
		}
		if = {
			limit = {
				has_character_modifier = fp1_excellent_longships_modifier
			}
			multiply = 0.5
		}
		if = {
			limit = {
				has_character_modifier = fp1_rotting_longships_modifier
			}
			multiply = 1.25
		}
		if = {
			limit = {
				AND = {
					exists = dynasty
					dynasty = { has_dynasty_modifier = fp1_legacy_of_piracy_modifier }
				}
			}
			multiply = 0.5
		}
		if = {
			limit = {
				has_character_modifier = fp2_advanced_maritime_technology_modifier
			}
			multiply = 0.35
		}
		#TODO add the building and holy site, check how modifiers are added
	}
	round = yes
}

round_me = {
	value = root
	if = {
		limit = {
			root < 1000
		}
		divide = 10
		round = yes
		multiply = 10
	}
	else = {
		divide = 100
		round = yes
		multiply = 100
	}
}

test_value_1 = {
	value = 100
}

loot_nearby = {
	# every_neighboring_province = {
	# 	limit = {
	# 		exists = county
	# 		NOT = {
	# 			county.holder.top_liege = scope:player.top_liege
	# 		}
	# 		has_holding = yes
	# 	}
	# 	add = available_loot
	# }
	if = {
		limit = {
			exists = county
		}
		county = {
			if = {
				limit = {
					NOT = {
						holder.top_liege = scope:player.top_liege
						holder = {
							OR = {
								has_raid_immunity_against = scope:player
								#TODO test if liege gives immunity
								any_liege_or_above = {
									has_raid_immunity_against = scope:player
								}
							}
						}
					}
				}
				every_county_province = {
					limit = {
						NOT = {
							this = root
						}
						has_holding = yes
						is_raided = no
						NOT = {
							has_province_modifier = recently_looted_modifier
						}
					}
					add = available_loot
				}
			}
		}
	}
	if = {
		limit = {
			has_variable_list = adjacent_counties
		}
		every_in_list = {
			variable = adjacent_counties
			limit = {
				NOT = {
					holder.top_liege = scope:player.top_liege
					holder = {
						OR = {
							has_raid_immunity_against = scope:player
							#TODO test if liege gives immunity
							any_liege_or_above = {
								has_raid_immunity_against = scope:player
							}
						}
					}
				}
			}
			every_county_province = {
				limit = {
					has_holding = yes
					is_raided = no
					NOT = {
						has_province_modifier = recently_looted_modifier
					}
				}
				add = available_loot
			}
		}
	}
}

loot_in_county = {
	every_county_province = {
		limit = {
			has_holding = yes
			is_raided = no
			NOT = {
				has_province_modifier = recently_looted_modifier
			}
		}
		add = available_loot
	}
}

strongest_liege = {
	if = {
		limit = {
			save_temporary_scope_value_as = {
				name = strongest
				value = current_military_strength
			}
		}
	}
	every_liege_or_above = {
		limit = {
			current_military_strength > scope:strongest
		}
		if = {
			limit = {
				save_temporary_scope_value_as = {
					name = strongest
					value = current_military_strength
				}
			}
		}
	}
	value = scope:strongest
}

raid_radius = {
	if = {
		limit = {
			ROOT = {
				NOT = {
					has_variable = raid_radius
				}
			}
		}
		value = 3
	}
	else = {
		value = root.var:raid_radius
	}
}

feast_province_score = {
	value = 0
	# BUILDINGS
	# Triple good / +++
	if = {
		limit = { has_building_or_higher = citadel_of_aleppo_01 }
		add = 100
	}
	if = {
		limit = { has_building_or_higher = palace_of_aachen_01 }
		add = 100
	}
	if = {
		limit = { has_building_or_higher = doges_palace_01 }
		add = 100
	}
	if = {
		limit = { has_building_or_higher = leisure_palace_01 }
		add = 100
	}
	if = {
		limit = { has_building_or_higher = alhambra_01 }
		add = 100
	}
	# Double good / ++
	if = {
		limit = { has_building_or_higher = farm_estates_01 }
		add = 50
	}
	# Good / +
	if = {
		limit = { has_building_or_higher = longhouses_01 }
		add = 25
	}
	if = {
		limit = { has_building_or_higher = orchards_01 }
		add = 25
	}
	if = {
		limit = { has_building_or_higher = cereal_fields_01 }
		add = 25
	}
	if = {
		limit = { has_building_or_higher = plantations_01 }
		add = 25
	}
}

num_of_count_vassals = {
	every_vassal = {
		limit = {
			highest_held_title_tier = tier_county
		}
		add = 1
	}
}

num_of_duke_vassals = {
	every_vassal = {
		limit = {
			highest_held_title_tier = tier_duchy
		}
		add = 1
	}
}

num_of_king_vassals = {
	every_vassal = {
		limit = {
			highest_held_title_tier = tier_kingdom
		}
		add = 1
	}
}

num_of_powerful_vassals = {
	every_powerful_vassal = {
		add = 1
	}
}

num_in_factions = {
	every_vassal = {
		limit = {
			is_a_faction_member = yes
		}
		add = 1
	}
}

num_faction_leaders = {
	every_vassal = {
		limit = {
			is_a_faction_leader = yes
		}
		add = 1
	}
}

num_can_join_faction = {
	every_vassal = {
		limit = {
			highest_held_title_tier > tier_barony
			is_a_faction_member = no
			common_can_character_join_trigger = {
				FACTION_TARGET = root
			}
		}
		add = 1
	}
}

num_vassals_like_you = {
	every_vassal = {
		limit = {
			highest_held_title_tier > tier_barony
			opinion = {
				target = root
				value >= 0
			}
		}
		add = 1
	}
}

num_vassals_hate_you = {
	every_vassal = {
		limit = {
			highest_held_title_tier > tier_barony
			opinion = {
				target = root
				value <= -50
			}
		}
		add = 1
	}
}

num_vassals_dislike_you = {
	every_vassal = {
		limit = {
			highest_held_title_tier > tier_barony
			opinion = {
				target = root
				value < 0
			}
			opinion = {
				target = root
				value > -50
			}
		}
		add = 1
	}
}

num_vassals_not_intimidated = {
	every_vassal = {
		limit = {
			highest_held_title_tier > tier_barony
			has_dread_level_towards = {
				target = liege
				level = 0
			}
		}
		add = 1
	}
}

num_vassals_intimidated = {
	every_vassal = {
		limit = {
			highest_held_title_tier > tier_barony
			has_dread_level_towards = {
				target = liege
				level > 0
			}
		}
		add = 1
	}
}

num_generous_vassals = {
	every_vassal = {
		limit = {
			highest_held_title_tier > tier_barony
			has_trait = generous
		}
		add = 1
	}
}

num_invlid_for_tour = {
	every_vassal = {
		limit = {
			OR = {
				highest_held_title_tier < tier_county
				is_available = no
				age < 12
			}
		}
		add = 1
	}
}

num_vassals_travelling = {
	every_vassal = {
		limit = {
			is_travelling = yes
		}
		add = 1
	}
}

num_vassals_is_in_army = {
	every_vassal = {
		limit = {
			is_in_army = yes
		}
		add = 1
	}
}
num_vassals_is_imprisoned = {
	every_vassal = {
		limit = {
			is_imprisoned = yes
		}
		add = 1
	}
}
num_vassals_has_contagious_deadly_disease_trigger = {
	every_vassal = {
		limit = {
			has_contagious_deadly_disease_trigger = yes
		}
		add = 1
	}
}
num_vassals_is_incapable = {
	every_vassal = {
		limit = {
			is_incapable = yes
		}
		add = 1
	}
}

num_vassals_in_activity = {
	every_vassal = {
		limit = {
			OR = {
				exists = involved_activity
				has_variable = homage_liege_scope
				has_character_flag = meditation_character_flag
				has_character_flag = petition_liege_character_flag
				has_character_flag = holding_court_character_flag
				is_being_visited_on_tour_strict = yes
			}
		}
		add = 1
	}
}

num_vassals_planning_activity = {
	every_vassal = {
		limit = {
			has_character_flag = planning_an_activity
		}
		add = 1
	}
}

num_vassals_gone_adventuring = {
	every_vassal = {
		limit = {
			has_variable = gone_adventuring
		}
		add = 1
	}
}

num_vassals_kids_for_tour = {
	every_vassal = {
		limit = {
			age < 12
		}
		add = 1
	}
}

num_vassals_barons = {
	every_vassal = {
		limit = {
			highest_held_title_tier < tier_county
		}
		add = 1
	}
}

num_vassals_titular = {
	every_vassal = {
		limit = {
			NOT = { exists = capital_province }
		}
		add = 1
	}
}

tournament_province_score = {
	add = {
		value = county.development_level
		divide = 2
	}
	if = {
		limit = {
			has_building_or_higher = hall_of_heroes_01
		}
		add = 30
	}
	else_if = {
		limit = {
			OR = {
				has_building_or_higher = jousting_lists_01
				has_building_or_higher = blacksmiths_01
				has_building_or_higher = archery_ranges_01
				has_building_or_higher = royal_armory_01
			}
		}
		add = 20
	}
	if = {
		limit = {
			OR = {
				has_building_or_higher = barracks_01
				has_building_or_higher = smiths_01
				has_building_or_higher = regimental_grounds_01
				has_building_or_higher = stables_01
				has_building_or_higher = military_camps_01
				has_building_or_higher = war_camps_01
			}
		}
		add = 10
	}
	if = {
		limit = {
			OR = {
				terrain = plains
				terrain = oasis
				terrain = steppe
			}
		}
		add = 5
	}
	else_if = {
		limit = {
			OR = {
				terrain = desert
				terrain = forest
				terrain = taiga
				terrain = jungle
				terrain = hills
			}
		}
		add = -5
	}
	else_if = {
		limit = {
			OR = {
				terrain = mountains
				terrain = desert_mountains
			}
		}
		add = -15
	}
	else_if = {
		limit = {
			OR = {
				terrain = floodplains
				terrain = wetlands
			}
		}
		add = -30
	}
	if = {
		limit = {
			county.development_level <= 5
		}
		add = -5
	}
	else_if = {
		limit = {
			county.development_level >= medium_development_level
			NOT = {
				county.development_level >= good_development_level
			}
		}
		add = 10
	}
	else_if = {
		limit = {
			county.development_level >= good_development_level
			NOT = {
				county.development_level >= great_development_level
			}
		}
		add = 20
	}
	else_if = {
		limit = {
			county.development_level >= great_development_level
		}
		add = 30
	}
}