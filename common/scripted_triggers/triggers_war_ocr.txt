is_county_safe = {
    # it's safe if
    save_temporary_scope_as = controller
    OR = {
        # I control it
        this = root

        # or my loyal vassal controls it
        AND = {
            is_vassal_or_below_of = root
            NOT = { is_at_war_with = root }
        }

        # or someone who
        NOR = {
            # is not at war with me
            is_at_war_with = root

            # their liege isn't at war with me
            # probably pointless? the controller should be their liege already
            any_liege_or_above = {
                is_at_war_with = root
            }

            # and they aren't at war with my liege
            root = {
                any_liege_or_above = {
                    is_at_war_with = scope:controller
                }
            }
        }
    }
}

is_county_friendly = {
    # it's safe if
    save_temporary_scope_as = controller

    OR = {
        # I control it
        this = root

        root = {
            any_liege_or_above = {
                this = scope:controller
                NOT = {
                    is_at_war_with = root
                }
            }
        }

        is_allied_in_war = root

        # or my loyal vassal controls it
        AND = {
            is_vassal_or_below_of = root
            NOT = { is_at_war_with = root }
        }
    }
}

is_hostile_to_me = {
    save_temporary_scope_as = owner
    OR = {
        is_at_war_with = root
        any_liege_or_above = {
            is_at_war_with = root
        }
        is_causing_raid_hostility_towards = root

        any_primary_war_enemy = {
            any_war_enemy = {
                this = root
            }
        }
    }
}