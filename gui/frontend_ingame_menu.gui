window = {
	name = "ingame_pausemenu"
	parentanchor = center
	movable = no
	size = { 100% 105% }
	layer = frontend
	filter_mouse = all

	background = {
		using = Background_Area_Dark
		margin = { 20 20 }
		# alpha = 0.7
	}

	background = {
		texture = "gfx/interface/illustrations/frontend/pause_bg.dds"

		modify_texture = {
			texture = "gfx/interface/frontend/fade_bg_ingame_menu.dds"
			blend_mode = alphamultiply
		}
	}

	state = {
		name = _show
		using = Animation_FadeIn_Quick

		position = { 0 0 }

		start_sound = {
			soundeffect = "snapshot:/States/MainMenu"
		}

		start_sound = {
			soundeffect = "event:/SFX/UI/Generic/sfx_ui_generic_tab"
		}
	}

	state = {
		name = _hide
		using = Animation_FadeOut_Quick
		start_sound = { soundeffect = "event:/SFX/UI/Generic/sfx_ui_generic_tab"}
		position_y = 10
	}

	widget = {
		size = { 100% 100% }
		scale = "[ScaleToFitElementOutside('(int32)1920', '(int32)1080')]"
		parentanchor = left|vcenter

		@button_height = 58


		widget = {
			parentanchor = vcenter
			position = { 172 -50 }

			vbox = {
				set_parent_size_to_minimum = yes

				vbox = {
					# spacing = 10

					text_single = {
						background = { using = Background_Area_Border_Solid }
						margin_left = 5
						layoutpolicy_horizontal = expanding
						name = "player_observer_indication"
						visible = "[And(GetPlayer.IsValid, IsObserver)]"
						raw_text = "Observing as [GetPlayer.GetShortUINameNotMeNoTooltip]."
					}

					spacer = {
						size = { 30 15 }
					}

					flowcontainer = {
					    direction = vertical
						layoutpolicy_horizontal = expanding

					    ignoreinvisible = yes

						button_text = {
							blockoverride "text" {
								raw_text = "Observe as [Character.GetFirstNameNoTooltip]. Click this with Control F."
							}
							onclick = "[DefaultOnCharacterClick( Character.GetID)]"
							visible = "[And(And(GetGlobalVariable('player').IsSet, IsObserver), Not(GetPlayer.IsValid))]"
							datacontext = "[GetGlobalVariable('player').GetCharacter]"
						}

						button_text = {
							visible = "[And(IsObserver, GetPlayer.IsValid)]"
							blockoverride "text" {
								raw_text = "Exit observer mode."
							}

							onclick = "[ExecuteConsoleCommand('ob')]"
						}
					}

					button_frontend = {
						size = { 332 @button_height }
						name = "resume_button"
						text = "RESUME"

						shortcut = "close_window"
						onclick = "[PauseMenu.Resume]"
					}

					vbox = {
						visible = "[GameHasMultiplePlayers]"
						spacing = 5

						background = {
							using = Background_Area_With_Header
							margin_bottom = 5
						}

						text_single = {
							margin = { 10 10 }
							layoutpolicy_horizontal = expanding
							text = "MULTI_PLAYER"
						}

						text_single = {
							visible = "[Not(IsGamePaused)]"
							text = "FRONTEND_NOT_PAUSED"
						}

						text_single = {
							visible = "[IsGamePaused]"
							text = "FRONTEND_IS_PAUSED"
						}

						text_single = {
							layoutpolicy_horizontal = expanding
							margin_left = 10
							text = "FRONTEND_PLAYERS_COUNT"
						}

						button_frontend = {
							name = "lobby_button"
							size = { 325 @button_height }
							text = "FRONTEND_GOTO_LOBBY"
							onclick = "[PauseMenu.OpenLobby]"
						}

						spacer = {
							size = { 10 10 }
						}

						hbox = {
							layoutpolicy_horizontal = expanding
							maximumsize = { 275 -1 }
							margin = { 10 5 }
							spacing = 5

							text_multi = {
								layoutpolicy_horizontal = expanding
								max_width = 275
								min_width = 275
								margin = { 0 5 }
								autoresize = yes
								text = "FRONTEND_INVITE"
							}

							button_copy = {
								onclick = "[CopyServerID]"
								tooltip = "FRONTEND_COPY_CLIPBUFFER_TT"
							}
						}
					}

					vbox = {
						margin_top = 20
						spacing = 30

						hbox = {
							visible = "[IsIronmanEnabled]"

							ironman_save_icon = {}

							vbox = {
								spacing = 5
								text_label_center = {
									text = IRONMAN_ENABLED
									default_format = "#low"
									using = Font_Size_Medium
								}
								text_multi = {
									max_width = 290
									min_width = 290
									autoresize = yes
									text = "IRONMAN_PAUSE_MENU_EXPLANATION"
									using = Font_Size_Small
								}
							}
						}

						vbox = {
							spacing = 4

							button_frontend = {
								name = "save_button"
								size = { 325 @button_height }
								text = "SAVE_GAME"
								visible = "[Not( IsIronmanEnabled )]"
								onclick = "[PauseMenu.Save]"
							}

							button_frontend = {
								name = "load_ingame_button"
								size = { 325 @button_height }
								text = "LOAD_GAME"

								visible = "[Not( GameHasMultiplePlayers )]"
								enabled = "[PauseMenu.CanLoadIngame]"
								onclick = "[PauseMenu.LoadIngame]"
								tooltip = "[PauseMenu.LoadIngameTooltip]"
							}

							button_frontend = {
								name = "open_lobby_button"
								size = { 325 @button_height }
								text = "OPEN_LOBBY"

								onclick = "[PauseMenu.OpenLobby]"
								visible = "[Not( Or( Or( Or( PauseMenu.IsLobbyOpen, IsIronmanEnabled ), GameIsMultiplayer ), Not( CanOpenLobby ) ) )]"
								tooltip = "[GetOpenLobbyTooltip]"
							}

							button_frontend = {
								name = "open_lobby_button_login"
								size = { 325 @button_height }
								text = "OPEN_LOBBY"

								onclick = "[OnToggleLoginWindow]"
								visible = "[Not( Or( Or( Or( PauseMenu.IsLobbyOpen, IsIronmanEnabled ), GameIsMultiplayer ), CanOpenLobby ) )]"
								tooltip = "[GetOpenLobbyTooltip]"

								icon_online_offline = {
									parentanchor = right|vcenter
									position = { -15 0 }
									frame = 1
								}
							}

							button_frontend = {
								name = "switch_character_button"
								size = { 325 @button_height }
								text = "FRONTEND_SWITCH_CHARACTER"

								onclick = "[PauseMenu.SwitchCharacter]"
								visible = "[Not( Or( Or( PauseMenu.IsLobbyOpen, IsIronmanEnabled ), GameHasMultiplePlayers ) )]"
							}

							button_frontend = {
								name = "exit_button"
								size = { 325 @button_height }
								text = "[PauseMenu.GetExitName]"
								onclick = "[PauseMenu.ExitGame( '(bool)yes' )]"
							}
						}
					}

					button_text = {

						layoutpolicy_horizontal = expanding
						visible = "[Not(IsObserver)]"
						blockoverride "text" {
							raw_text = "Switch to observer mode."
						}
						# onclick = "[GetVariableSystem.Set('player', GetPlayer.GetID)]"
						onclick = "[ExecuteConsoleCommand('effect set_global_variable = { name = player value = root }')]"
						onclick = "[PdxGuiWidget.TriggerAnimation('next')]"

						state = {
							name = next
							duration = 0.1
							next = b
							alpha = 1
						}
						state = {
							alpha = 1
							name = b
							on_finish = "[ExecuteConsoleCommand('ob')]"
						}
					}

					flowcontainer = {
						margin_top = 15
						margin = { 10 0 }
						spacing = 2
						layoutpolicy_horizontal = expanding

						direction = vertical
						# spacing = 50

						button_text = {
							onclick = "[OnToggleLoginWindow]"
							blockoverride "text" {
								text = "ACCOUNT"
							}
						}

						button_text = {
							onclick = "[PauseMenu.OpenSettings]"
							blockoverride "text" {
								text = "SETTINGS"
							}
						}

						button_text = {
							onclick = "[OpenAchievements]"
							visible = "[AreAchievementsAvailable]"
							blockoverride "text" {
								text = "ACHIEVEMENTS_LABEL"
							}
						}
						button_text = {
							onclick = "[OpenGameRules]"
							blockoverride "text" {
								text = "GAME_RULES"
							}
						}
					}
				}

				text_single = {
					layoutpolicy_horizontal = expanding
					raw_text = "Mod settings:"
					margin = { 0 10 }
				}

				flowcontainer = {
					margin = { 10 0 }
					direction = vertical
					layoutpolicy_horizontal = expanding
					# parentanchor = hcenter|vcenter
					# position = { 210 90 }
					background = { using = Background_Area_Dark }

					spacing = 10

					@height = 30

					button_text = {
						blockoverride "text" {
							raw_text = "Text view [AddTextIf(GetVariableSystem.Exists('ocr'), 'Disabled')][AddTextIf(Not(GetVariableSystem.Exists('ocr')), 'Enabled')], hotkey Shift + F11."
						}
						down = "[Not(GetVariableSystem.Exists('ocr'))]"
						onclick = "[GetVariableSystem.Toggle('ocr')]"
					}

					button_text = {
						blockoverride "text" {
							raw_text = "Daily tick sound [AddTextIf(GetVariableSystem.Exists('daily_sound'), 'Disabled.')][AddTextIf(Not(GetVariableSystem.Exists('daily_sound')), 'Enabled.')]"
						}
						down = "[Not(GetVariableSystem.Exists('daily_sound'))]"
						onclick = "[GetVariableSystem.Toggle('daily_sound')]"
					}

					button_text = {
						blockoverride "text" {
							raw_text = "Tick sound [AddTextIf(GetVariableSystem.Exists('daily_sound_loud'), 'Loud.')][AddTextIf(Not(GetVariableSystem.Exists('daily_sound_loud')), 'Quiet.')]"
						}
						down = "[Not(GetVariableSystem.Exists('daily_sound_loud'))]"
						onclick = "[GetVariableSystem.Toggle('daily_sound_loud')]"
					}

					button_text = {
						blockoverride "text" {
							raw_text = "Monthly tick [AddTextIf(GetVariableSystem.Exists('monthly_sound'), 'Disabled.')][AddTextIf(Not(GetVariableSystem.Exists('monthly_sound')), 'Enabled.')]"
						}
						down = "[Not(GetVariableSystem.Exists('monthly_sound'))]"
						onclick = "[GetVariableSystem.Toggle('monthly_sound')]"
					}

					button_text = {
						blockoverride "text" {
							raw_text = "Tooltip focus [AddTextIf(GetVariableSystem.Exists('tooltip_focus'), 'Disabled.')][AddTextIf(Not(GetVariableSystem.Exists('tooltip_focus')), 'Enabled.')]"
						}
						down = "[Not(GetVariableSystem.Exists('tooltip_focus'))]"

						onclick = "[GetVariableSystem.Toggle('tooltip_focus')]"
					}

					# button_standard = {
					# 	size = { 332 @height }
					# 	raw_text = "Window focus [AddTextIf(GetVariableSystem.Exists('window_focus'), 'Disabled.')] [AddTextIf(Not(GetVariableSystem.Exists('window_focus')), 'Enabled.')]"
					# 	down = "[Not(GetVariableSystem.Exists('window_focus'))]"
					#
					# 	onclick = "[GetVariableSystem.Toggle('window_focus')]"
					# }

					button_text = {
						blockoverride "text" {
							raw_text = "Interactions close character view, [AddTextIf(GetVariableSystem.Exists('close_char'), 'Disabled.')] [AddTextIf(Not(GetVariableSystem.Exists('close_char')), 'Enabled.')]"
						}
						down = "[Not(GetVariableSystem.Exists('close_char'))]"

						onclick = "[GetVariableSystem.Toggle('close_char')]"
					}

					button_text = {
						blockoverride "text" {
							raw_text = "Map tooltips [Select_CString(Not(GetVariableSystem.Exists('hide_tooltips')), 'Hidden', 'Visible')], hotkey Y."
						}
						down = "[GetVariableSystem.Exists('hide_tooltips')]"

						onclick = "[GetVariableSystem.Toggle('hide_tooltips')]"
					}

					button_text = {
						blockoverride "text" {
							raw_text = "Numbered character lists[Select_CString(Not(GetVariableSystem.Exists('index')), ', Disabled.', ', Enabled.')]"
						}
						down = "[GetVariableSystem.Exists('index')]"

						onclick = "[GetVariableSystem.Toggle('index')]"
					}
				}
				spacer = {
					size = { 30 15 }
				}
			}
		}

		hotkeys_window = { }

		clickable_version_number = {
			parentanchor = bottom|right
			position = { -20 -40 }
			blockoverride "version_text" {
				text = "VERSION_SHORT"
				align = center
			}
		}
	}
}

window = {
	name = "ingame_load_ingame"
	movable = no
	layer = confirmation
	size = { 100% 100% }

	using = Animation_ShowHide_Quick
	using = Background_Full_Dim

	button_normal = {
		size = { 100% 100% }
		onclick = "[LoadIngameWindow.OnBack]"
	}

	widget_load_game = {
		parentanchor = center
		size = { 1030 100% }

		blockoverride "datamodel_savegames"
		{
			datamodel = "[LoadIngameWindow.GetSaveGames]"
		}

		blockoverride "invalid_saves_click"
		{
			onclick = "[LoadIngameWindow.OnShowInvalidSavegames]"
		}

		blockoverride "invalid_saves_checked"
		{
			visible = "[Not(LoadIngameWindow.ShouldShowInvalidSavegames)]"
		}

		blockoverride "button_back"
		{
			onclick = "[LoadIngameWindow.OnBack]"
		}

		blockoverride "selected_save"
		{
			datacontext = "[LoadIngameWindow.GetSelectedSavegame]"
			visible = "[LoadIngameWindow.HasSelectedSavegame]"
		}

		blockoverride "button_delete_save"
		{
			onclick = "[LoadIngameWindow.OnDelete]"
		}

		blockoverride "button_load_save"
		{
			onclick = "[LoadIngameWindow.OnLoad]"
		}
		blockoverride "layout_widget"
		{
			visible = "[Not(LoadIngameWindow.HasSelectedSavegame)]"
		}
	}
}

Types SaveGameTypes
{
	type cloud_save_checkbutton = button_checkbox
	{
		name = "cloud_save" # Name referenced from code
		checked = "[CloudSaveData.ShouldSaveToCloud]"
		tooltip = "[CloudSaveData.GetCloudSaveTooltip]"
		onclick = "[CloudSaveData.OnCloudSaveClick]"
		enabled = "[CloudSaveData.AreCloudSavesAvailable]"
	}
}