types OCR_siege  {
	type old_siege = vbox {
		name = "window_content"
		margin_right = 35
		margin_top = 30
		set_parent_size_to_minimum = yes

		### Header ###
		hbox = {
			min_width = 550
			layoutpolicy_horizontal = expanding
			margin_right = 15
			margin_left = 5
			margin_top = 5
			margin_bottom = 5

			background = {
				using = Background_Area_Dark
				margin_left = 5
			}

			background = {
				visible = "[Not(SiegeWindow.GetSiege.IsPlayerInAttackerSide)]"
				texture = "gfx/interface/component_masks/mask_header_lines.dds"
				using = Color_Red
				alpha = 0.25
				spriteType = corneredtiled
				spriteborder_left = 340
				texture_density = 2
				margin = { 0 -3 }
				using = Mask_Rough_Edges
			}

			background = {
				visible = "[SiegeWindow.GetSiege.IsPlayerInAttackerSide]"
				texture = "gfx/interface/component_masks/mask_header_lines.dds"
				using = Color_Green
				alpha = 0.25
				spriteType = corneredtiled
				spriteborder_left = 340
				texture_density = 2
				margin = { 0 -3 }
				using = Mask_Rough_Edges
			}

			highlight_icon = {
				size = { 40 40 }
				name = "blocked_icon"
				texture = "gfx/interface/icons/map_icons/icon_siege.dds"
				tooltip = "[Siege.GetSiegeDescription]"
			}

			text_single = {
				name = "title"
				text = "[SiegeWindow.GetSiege.GetName]"
				margin_left = 5
				margin_bottom = 4
				using = Font_Size_Big
				font = TitleFont
				default_format = "#high;glow_color:{0,0,0,1}"
			}

			expand = {}

			hbox = {
				icon = { # Mild Winter
					name = "winter_level_icon_mild"
					datacontext = "[SiegeWindow.GetSiege.GetProvince]"
					visible = "[Province.HasWinterLevel( '(int32)1' )]"
					texture = "gfx/interface/icons/terrain_types/winter_mild.dds"
					size = { 35 35 }
					tooltip = "PROVINCE_VIEW_TOOLTIP_WINTER"
				}

				icon = { # Normal Winter
					name = "winter_level_icon_normal"
					datacontext = "[SiegeWindow.GetSiege.GetProvince]"
					visible = "[Province.HasWinterLevel( '(int32)2' )]"
					texture = "gfx/interface/icons/terrain_types/winter_normal.dds"
					size = { 35 35 }
					tooltip = "PROVINCE_VIEW_TOOLTIP_WINTER"
				}

				icon = { # Harsh Winter
					name = "winter_level_icon_harsh"
					datacontext = "[SiegeWindow.GetSiege.GetProvince]"
					visible = "[Province.HasWinterLevel( '(int32)3' )]"
					texture = "gfx/interface/icons/terrain_types/winter_harsh.dds"
					size = { 35 35 }
					tooltip = "PROVINCE_VIEW_TOOLTIP_WINTER"
				}

				spacing = 3

				icon = {
					datacontext = "[SiegeWindow.GetSiege.GetProvince.GetTerrain]"
					texture = "[Terrain.GetIcon]"
					tooltip = "HOLDING_TERRAIN_TOOLTIP"
					size = { 35 35 }
				}
			}

			button_group = {
				onclick = "[SiegeWindow.OpenArmyWindow]"
				visible = "[SiegeWindow.HasPlayerOwnedArmies]"
				tooltip = "SW_TT_OPEN_ARMY_WINDOW"
				using = tooltip_ne

				highlight_icon = {
					parentanchor = vcenter
					widgetanchor = vcenter
					size = { 40 40 }
					name = "blocked_icon"
					texture = "gfx/interface/icons/map_icons/onmap_army_icon.dds"
				}
			}

			button_group = {
				onclick = "[SiegeWindow.OpenHoldingView]"
				tooltip = "SW_TT_SHOW_HOLDING"
				shortcut = county_go_to_siege
				using = tooltip_ne

				highlight_icon = {
					parentanchor = vcenter
					widgetanchor = vcenter
					size = { 40 40 }
					name = "blocked_icon"
					texture = "gfx/interface/icons/map_icons/onmap_holding_icon.dds"
				}
			}

			spacer = {
				size = { 10 10 }
			}

			buttons_window_control = {
				blockoverride "button_go_to"
				{
					onclick = "[DefaultOnCoatOfArmsRightClick( SiegeWindow.GetSiege.GetProvince.GetCounty.GetTitle.GetID)]"
					tooltip = "GOTO_PROVINCE_TT"
					using = tooltip_ne
					oversound = "event:/SFX/UI/Generic/sfx_ui_generic_icon_pointer_over"
					clicksound = "event:/SFX/UI/Generic/sfx_ui_generic_icon_select"
				}

				blockoverride "button_close"
				{
					onclick = "[SiegeWindow.Close]"
				}
			}
		}

		widget = {
			layoutpolicy_horizontal = expanding
			size = { 0 270 }

			state = {
				name = "siege_window_refresh"
				using = Animation_Refresh_FadeOut
			}

			state = {
				using = Animation_Refresh_FadeIn
			}

			proportional_icon = {
				size = { 100% 100% }
				texture = "[SiegeWindow.GetSiege.GetProvince.GetHolding.GetIllustration]"

				using = Mask_Rough_Edges

				modify_texture = {
					texture = "gfx/interface/component_masks/mask_holding_illustration.dds"
					blend_mode = alphamultiply
				}

				modify_texture = {
					name = "orange"
					texture = "gfx/interface/colors/orange.dds"
					blend_mode = colordodge
					alpha = "[Multiply_float(Multiply_float( IntToFloat(GetProgressBarValueMax( SiegeWindow.GetSiege.GetProgress, '(float)100' )), '(float)0.01'), Multiply_float( IntToFloat(GetProgressBarValueMax( SiegeWindow.GetSiege.GetProgress, '(float)100' )), '(float)0.005'))]"
				}
			}

			proportional_icon = {
				visible = "[Not(SiegeWindow.GetSiege.IsBlocked)]"
				size = { 100% 100% }
				texture = "gfx/interface/window_siege/base_holding_fire.dds"

				using = Mask_Rough_Edges

				modify_texture = {
					name = "orange"
					texture = "gfx/interface/colors/orange.dds"
					blend_mode = colordodge
					alpha = "[Multiply_float(Multiply_float( IntToFloat(GetProgressBarValueMax( SiegeWindow.GetSiege.GetProgress, '(float)100' )), '(float)0.005'), Multiply_float( IntToFloat(GetProgressBarValueMax( SiegeWindow.GetSiege.GetProgress, '(float)100' )), '(float)0.005'))]"
				}

				modify_texture = {
					name = "fire"
					framesize = { 200 120 }
					texture = "gfx/interface/component_effects/fire_03.dds"
					blend_mode = colordodge
				}

				using = Animation_ShowHide_Standard
				using = Animation_Frames_100_Modify

				state = {
					name = "siege_progress_0"
					duration = 0.3
					alpha = 0
				}

				state = {
					name = "siege_progress_50"
					duration = 1
					alpha = 0.2
					start_sound = {
						soundeffect = "event:/SFX/UI/Siege/sfx_ui_siege_vfx_fire_01"
					}
				}

				state = {
					name = "siege_progress_70"
					duration = 1
					alpha = 0.35
					start_sound = {
						soundeffect = "event:/SFX/UI/Siege/sfx_ui_siege_vfx_fire_02"
					}
				}

				state = {
					name = "siege_progress_85"
					duration = 1
					alpha = 0.6
					start_sound = {
						soundeffect = "event:/SFX/UI/Siege/sfx_ui_siege_vfx_fire_03"
					}
				}
			}

			widget = {
				size = { 100% 100% }
				datacontext = "[SiegeWindow.GetSiege]"
				visible = "[SiegeWindow.GetSiege.IsBlocked]"
				using = Animation_ShowHide_Standard

				icon = {
					name = "pause"
					alpha = 0.2
					size = { 100% 100% }
					texture = "gfx/interface/hud/speed_indicator_auto_pause.dds"

					using = Mask_Rough_Edges
				}

				text_label_center = {
					parentanchor = center
					tooltip = "[Siege.GetBlockedReason]"
					text = "[Siege.GetBlockedReasonShort]"
				}
			}

			vbox = {
				margin_top = 5

				hbox = {
					name = "progressbar_area"
					datacontext = "[SiegeWindow.GetSiege.GetSiegingRealmCharacter]"
					layoutpolicy_horizontal = expanding

					hbox = {
						layoutpolicy_horizontal = expanding
						layoutstretchfactor_horizontal = 1
						margin_bottom = 5

						coa_realm_medium = {
							name = "occupant_realm"
							visible = "[SiegeWindow.GetSiege.HasSiegingRealm]"
							tooltip = "SW_TT_SIEGING_REALM_TOOLTIP"
							using = tooltip_ws

							using = Animation_ShowHide_Standard
						}
					}

					vbox = {
						layoutpolicy_vertical = expanding

						hbox = {
							layoutpolicy_horizontal = expanding
							margin_top = 5

							tooltip = "[SiegeWindow.GetSiegeProgressTooltip]"
							using = tooltip_above

							widget = {
								size = { 370 45 }

								widget = {
									size = { 100% 100% }
									scissor = yes

									margin_widget = {
										size = { 100% 100% }
										margin = { 0 5 }

										background = {
											texture = "gfx/interface/progressbars/war_progress_noprogress.dds"
											margin = { 0 -3 }
										}

										widget = {
											visible = "[GreaterThan_float(SiegeWindow.GetSiege.GetProgress, '(float)60')]"
											size = { 100% 100% }
											using = Animation_ShowHide_Standard

											widget = {
												size = { 100% 100% }
												alpha = 0.5

												state = {
													name = a
													next = b
													trigger_on_create = yes
													duration = 1
													alpha = 0.3
												}

												state = {
													name = b
													next = a
													duration = 1
													alpha = 0.1
												}

												icon = {
													visible = "[Not(SiegeWindow.GetSiege.IsPlayerInAttackerSide)]"
													size = { 100% 100% }
													texture = "gfx/interface/colors/white.dds"
													using = Color_Red
													alpha = "[Multiply_float(Multiply_float( IntToFloat(GetProgressBarValueMax( SiegeWindow.GetSiege.GetProgress, '(float)100' )), '(float)0.01'), Multiply_float( IntToFloat(GetProgressBarValueMax( SiegeWindow.GetSiege.GetProgress, '(float)100' )), '(float)0.01'))]"
													shaderfile = "gfx/FX/pdxgui_repeat_texture.shader"

													modify_texture = {
														name = "clouds"
														texture = "gfx/interface/component_masks/mask_clouds.dds"
														blend_mode = alphamultiply
														spriteType = corneredtiled
														texture_density = 2
													}

													state = {
														name = a
														next = b
														trigger_on_create = yes

														modify_texture = {
															name = "clouds"
															translate_uv = { -1 0 }
														}
													}

													state = {
														name = b
														next = a
														duration = 2

														modify_texture = {
															name = "clouds"
															translate_uv = { 1 0 }
														}
													}
												}

												icon = {
													visible = "[SiegeWindow.GetSiege.IsPlayerInAttackerSide]"
													size = { 100% 100% }
													texture = "gfx/interface/colors/white.dds"
													using = Color_Green
													alpha = "[Multiply_float(Multiply_float( IntToFloat(GetProgressBarValueMax( SiegeWindow.GetSiege.GetProgress, '(float)100' )), '(float)0.01'), Multiply_float( IntToFloat(GetProgressBarValueMax( SiegeWindow.GetSiege.GetProgress, '(float)100' )), '(float)0.01'))]"
													shaderfile = "gfx/FX/pdxgui_repeat_texture.shader"

													modify_texture = {
														name = "clouds"
														texture = "gfx/interface/component_masks/mask_clouds.dds"
														blend_mode = alphamultiply
														spriteType = corneredtiled
														texture_density = 2
													}

													state = {
														name = a
														next = b
														trigger_on_create = yes

														modify_texture = {
															name = "clouds"
															translate_uv = { -1 0 }
														}
													}

													state = {
														name = b
														next = a
														duration = 2

														modify_texture = {
															name = "clouds"
															translate_uv = { 1 0 }
														}
													}
												}
											}
										}
									}

									hbox = {
										margin = { 0 3 }

										widget_progressbar_siege = {
											visible = "[Not(SiegeWindow.GetSiege.IsPlayerInAttackerSide)]"
											layoutpolicy_horizontal = expanding
											layoutpolicy_vertical = expanding
											layoutstretchfactor_horizontal = "[GetProgressBarValueMaxScaled( SiegeWindow.GetSiege.GetProgress, '(float)100', '(int32)370' )]"

											blockoverride "progressbar_texture"
											{
												texture = "gfx/interface/progressbars/war_progress_red.dds"
											}

											blockoverride "arrows_color"
											{
												texture = "gfx/interface/hud/speed_indicator_pause.dds"
											}
										}

										widget_progressbar_siege = {
											visible = "[SiegeWindow.GetSiege.IsPlayerInAttackerSide]"
											layoutpolicy_horizontal = expanding
											layoutpolicy_vertical = expanding
											layoutstretchfactor_horizontal = "[GetProgressBarValueMaxScaled( SiegeWindow.GetSiege.GetProgress, '(float)100', '(int32)370' )]"
										}

										widget = {
											layoutpolicy_horizontal = expanding
											layoutpolicy_vertical = expanding
											layoutstretchfactor_horizontal = "[GetProgressBarValueMaxOtherScaled( SiegeWindow.GetSiege.GetProgress, '(float)100', '(int32)370' )]"
										}
									}
								}

								widget = {
									name = "power_bar_frame"
									parentanchor = top
									size = { 100% 100% }
									alwaystransparent = yes

									background = {
										texture = "gfx/interface/progressbars/siege_frame.dds"
										spriteType = Corneredstretched
										spriteborder = { 30 40 }
										margin = { 5 0 }
										margin_bottom = 10
										texture_density = 2
									}
								}
							}
						}

						spacer = {
							size = { 10 10 }
						}

						text_label_center = {
							name = "time_left"
							visible = "[Not(SiegeWindow.GetSiege.IsBlocked)]"
							text = "[SiegeWindow.GetTimeLeftShort]"
							tooltip = "SW_TIME_LEFT_TT"

							using = Animation_ShowHide_Standard
						}

						expand = {}
					}

					hbox = {
						layoutpolicy_horizontal = expanding
						layoutstretchfactor_horizontal = 1
						margin_bottom = 5

						coa_realm_medium = {
							name = "defending_realm"
							datacontext = "[SiegeWindow.GetSiege.GetProvince.GetController]"
							tooltip = "SW_TT_DEFENDING_REALM_TOOLTIP"
						}
					}
				}

				expand = {}

				hbox = {
					layoutpolicy_horizontal = expanding
					margin = { 7 0 }
					spacing = 10
					using = Animation_ShowHide_Standard

					expand = {}

					icon = {
						name = "holding_level_high"
						visible = "[SiegeWindow.GetSiege.FortLevelHasImpact]"
						texture = "gfx/interface/window_siege/fort_icon.dds"
						size = { 30 25 }
						tooltip = "[SiegeWindow.GetFortLevelImpactTooltip]"

						container = {
							parentanchor = bottom|right
							position = { 8 2 }

							icon = {
								name = "fort_level_bad"
								visible = "[SiegeWindow.GetSiege.IsPlayerInAttackerSide]"
								size = { 20 20 }
								texture = "gfx/interface/icons/symbols/icon_cross.dds"
							}

							icon = {
								name = "fort_level_good"
								visible = "[Not(SiegeWindow.GetSiege.IsPlayerInAttackerSide)]"
								size = { 20 20 }
								texture = "gfx/interface/icons/symbols/icon_check.dds"
							}
						}
					}

					hbox = {
						name = "tutorial_highlight_holding_view_loot_box"
						datacontext = "[SiegeWindow.GetSiege]"
						tooltip = "[Province.GetRaidLootTooltip]"
						margin = { 15 5 }
						spacing = 3

						background = {
							using = Background_Area_Dark
						}

						text_single = {
							text = "HOLDING_LOOT"
							default_format = "#high"
							align = nobaseline
						}

						text_single = {
							raw_text = "@gold_icon! [Siege.GetProvince.GetRaidLoot|0]"
							default_format = "#high"
							align = nobaseline
						}
					}
				}

				hbox = {
					datacontext = "[SiegeWindow.GetSiege]"
					datacontext = "[SiegeWindow.GetAttackerUnitItem]"
					layoutpolicy_horizontal = expanding
					margin_bottom = 5

					tooltip = "[SiegeWindow.GetNumberOfTroopsTooltip]"
					using = tooltip_above

					hbox = {
						layoutpolicy_horizontal = expanding
						layoutstretchfactor_horizontal = 1
						margin_bottom = 8
						margin_right = 25
						spacing = 5

						expand = {}

						hbox = {
							visible = "[Not(SiegeWindow.GetSiege.IsBlocked)]"

							using = Animation_ShowHide_Standard

							container_allied_unit_icon_item = {
								blockoverride "unit_items" {}
								blockoverride "multi_select" {}
								blockoverride "onclick" {}
								blockoverride "siege_window" {}
							}

							container_hostile_unit_icon_item = {
								blockoverride "unit_items" {}
								blockoverride "multi_select" {}
								blockoverride "siege_window" {}
							}
						}
					}

					icon = {
						size = { 220 20 }


						hbox = {
							widget = {
								layoutpolicy_horizontal = expanding
								layoutpolicy_vertical = expanding
								layoutstretchfactor_horizontal = "[GetProgressBarValueMax( Siege.GetSiegeMenBalance, '(float)100' )]"

								icon = {
									size = { 100% 100% }
									texture = "gfx/interface/progressbars/progress_standard.dds"
									spriteType = Corneredtiled
									spriteborder = { 6 6 }

									modify_texture = {
										name = "horizontal_wipe"
										texture = "gfx/interface/component_masks/mask_fade_horizontal_middle_solid.dds"
										blend_mode = mask
									}

									modify_texture = {
										name = "colordodge"
										texture = "gfx/interface/colors/white.dds"
										blend_mode = colordodge
										alpha = 0.1
									}

									state = {
										name = "monthly_tick_attacker_most_casualties"
										next = b
										trigger_on_create = yes

										modify_texture = {
											name = "horizontal_wipe"
											translate_uv = { -1 0 }
										}
									}

									state = {
										name = b
										next = b
										duration = 0.3
										using = Animation_Curve_Default


										modify_texture = {
											name = "horizontal_wipe"
											translate_uv = { 1 0 }
										}
									}
								}
							}

							widget = {
								layoutpolicy_horizontal = expanding
								layoutpolicy_vertical = expanding
								layoutstretchfactor_horizontal = "[GetProgressBarValueMaxOther( Siege.GetSiegeMenBalance, '(float)100' )]"

								icon = {
									size = { 100% 100% }
									texture = "gfx/interface/progressbars/progress_red.dds"
									spriteType = Corneredtiled
									spriteborder = { 6 6 }

									modify_texture = {
										name = "horizontal_wipe"
										texture = "gfx/interface/component_masks/mask_fade_horizontal_middle_solid.dds"
										blend_mode = mask
									}

									modify_texture = {
										name = "colordodge"
										texture = "gfx/interface/colors/white.dds"
										blend_mode = colordodge
										alpha = 0.1
									}

									state = {
										name = "monthly_tick_defender_most_casualties"
										next = b
										trigger_on_create = yes

										modify_texture = {
											name = "horizontal_wipe"
											translate_uv = { 1 0 }
										}
									}

									state = {
										name = b
										next = b
										duration = 0.3
										using = Animation_Curve_Default


										modify_texture = {
											name = "horizontal_wipe"
											translate_uv = { -1 0 }
										}
									}
								}
							}
						}

						progress_threshold = {
							parentanchor = center
							size = { 5 20 }
						}
					}

					hbox = {
						layoutpolicy_horizontal = expanding
						layoutstretchfactor_horizontal = 1
						margin = { 10 0 }

						hbox = {

							hbox = {
								spacing = 5
								tooltip = "[Province.GetFortLevelTooltip]"

								icon = {
									name = "icon_fort"
									texture = "gfx/interface/window_siege/fort_icon.dds"
									size = { 30 25 }
								}

								text_single = {
									text = "[SiegeWindow.GetSiege.GetProvince.GetFortLevel]"
									default_format = "#high"
									align = nobaseline
									min_width = 20
								}
							}

							hbox = {
								spacing = 3

								icon = {
									texture = "gfx/interface/icons/icon_garrison.dds"
									size = { 40 40 }
								}

								text_single = {
									name = "defender_side"
									text = "[Siege.GetDefenderMen]"
									default_format = "#high"
									align = nobaseline
									min_width = 35
								}
							}
						}

						expand = {}
					}
				}
			}
		}

		divider = {
			layoutpolicy_horizontal = expanding
		}

		####################################
		########### HOLDING INFO ###########
		####################################

		widget = {
			name = "holding_info"
			layoutpolicy_horizontal = expanding
			size = { 0 240 }

			vbox = {
				margin = { 10 10 }

				hbox = {
					layoutpolicy_horizontal = expanding
					spacing = 5

					vbox = {
						layoutpolicy_horizontal = expanding
						layoutpolicy_vertical = expanding
						layoutstretchfactor_horizontal = 1

						# Daily Progress
						widget = {
							layoutpolicy_horizontal = expanding
							size = { 0 110 }
							tooltip = "[SiegeWindow.GetDailyProgressTooltip]"

							background = {
								using = Background_Area
							}

							icon = {
								size = { 100% 100% }
								texture = "gfx/interface/colors/white.dds"
								using = Color_Blue_Transparent
								using = Mask_Rough_Edges

								modify_texture = {
									name = "horizontal_wipe"
									texture = "gfx/interface/component_masks/mask_fade_horizontal_middle.dds"
									blend_mode = alphamultiply
								}

								state = {
									name = "siege_daily_progress_flash"
									next = b
									trigger_on_create = yes

									modify_texture = {
										name = "horizontal_wipe"
										translate_uv = { 1 0 }
									}
								}

								state = {
									name = b
									duration = 0.8
									using = Animation_Curve_Default


									modify_texture = {
										name = "horizontal_wipe"
										translate_uv = { -1 0 }
									}
								}
							}

							vbox = {
								margin = { 10 10 }

								state = {
									name = "siege_window_refresh"
									using = Animation_Refresh_FadeOut
								}

								state = {
									using = Animation_Refresh_FadeIn
								}

								hbox = {
									layoutpolicy_horizontal = expanding
									spacing = 3

									icon = {
										size = { 52 52 }
										texture = "gfx/interface/icons/regimenttypes/unit_stat_siege_progress.dds"
									}

									text_multi = {
										align = nobaseline
										autoresize = yes
										max_width = 110
										text = SW_DAILY_SIEGE_PROGRESS
									}

									expand = {}
								}

								text_single = {
									text = "SW_DAILY_PROGRESS"
									using = Font_Size_Big
								}

								expand = {}
							}
						}

						# Siege Machines
						widget = {
							layoutpolicy_horizontal = expanding
							size = { 0 110 }

							background = {
								using = Background_Area
							}

							widget = {
								name = "siege_machine_box"
								datacontext = "[SiegeWindow.GetStrongestSiegeRegiment.GetMAAType]"
								datacontext = "[GetPlayer]"
								visible = "[DataModelHasItems(SiegeWindow.GetSiegeMachinesRegiments)]"
								size = { 100% 100% }

								using = Animation_ShowHide_Standard

								state = {
									name = "siege_window_refresh"
									using = Animation_Refresh_FadeOut
								}

								state = {
									using = Animation_Refresh_FadeIn
								}

								tooltipwidget = {
									overlappingitembox = {
										name = "siege_machines_box"
										alwaystransparent = no
										size = { 180 40 }
										using = DefaultTooltipBackground

										vbox = {
											layoutpolicy_horizontal = expanding
											set_parent_size_to_minimum = yes
											margin = { 10 5 }
											spacing = 10

											text_label_left = {
												layoutpolicy_horizontal = expanding
												name = "header"
												raw_text = "[siege_weapons|E]:"
												maximumsize = { 400 -1 }
											}

											dynamicgridbox = {
												datamodel = "[SiegeWindow.GetSiegeMachinesRegiments]"
												layoutpolicy_horizontal = expanding
												flipdirection = yes

												item = {
													widget = {
														datacontext = "[Regiment.GetMAAType]"
														datacontext = "[GetPlayer]"
														size = { 40 40 }

														icon = {
															name = "machine_icon"

															block "overlay_size"
															{
																size = { 40 40 }
															}

															alwaystransparent = yes
															texture = "[MenAtArmsType.GetIcon]"
														}

														tooltipwidget = {
															using = maa_type_container_tooltip
														}

														using = tooltip_nw
													}
												}

												expand = {}
											}
										}
									}
								}

								background = {
									texture = "[MenAtArmsType.GetHorizontalImage]"
									using = Mask_Rough_Edges
								}

								vbox = {
									expand = {}

									hbox = {
										layoutpolicy_horizontal = expanding
										margin = { 10 5 }

										text_single = {
											layoutpolicy_horizontal = expanding
											text = "SW_SIEGE_WEAPON"
											align = nobaseline
										}

										text_single = {
											margin = { 5 0 }
											text = "[SiegeWindow.GetSiegeMachinesCount]"
											default_format = "#high"
											using = Font_Size_Medium
											align = nobaseline
										}
									}
								}

								using = tooltip_nw
							}

							widget = {
								visible = "[Not(DataModelHasItems(SiegeWindow.GetSiegeMachinesRegiments))]"
								size = { 100% 100% }

								using = Animation_ShowHide_Standard

								state = {
									name = "siege_window_refresh"
									using = Animation_Refresh_FadeOut
								}

								state = {
									using = Animation_Refresh_FadeIn
								}

								text_single = {
									text = "SW_SIEGE_WEAPON_NON"
									parentanchor = center
								}
							}
						}
					}

					vbox = {
						layoutpolicy_horizontal = expanding
						layoutpolicy_vertical = expanding
						layoutstretchfactor_horizontal = 1

						widget = {
							layoutpolicy_horizontal = expanding
							layoutpolicy_vertical = expanding
							size = { 0 160 }
							tooltip = "[SiegeWindow.GetSiegePhaseTooltip]"

							background = {
								using = Background_Area
							}

							icon = {
								size = { 100% 100% }
								texture = "gfx/interface/colors/white.dds"
								using = Color_Blue_Transparent
								alpha = 0

								using = Mask_Rough_Edges

								modify_texture = {
									name = "flash"
									texture = "gfx/interface/component_masks/mask_fade_horizontal_middle.dds"
									blend_mode = alphamultiply
								}

								state = {
									name = "siege_event_flash"
									next = b
									trigger_on_create = yes
									using = Animation_Curve_Default
									duration = 0.3
									alpha = 1

									modify_texture = {
										name = "flash"
										alpha = 0
									}
								}

								state = {
									name = b
									duration = 1
									using = Animation_Curve_Default
									alpha = 0


									modify_texture = {
										name = "flash"
										alpha = 1
									}
								}
							}

							hbox = {
								state = {
									name = "siege_window_refresh"
									using = Animation_Refresh_FadeOut
								}

								state = {
									using = Animation_Refresh_FadeIn
								}

								vbox = {
									layoutpolicy_horizontal = expanding
									layoutpolicy_vertical = expanding
									spacing = 5
									margin_bottom = 5

									hbox = {
										layoutpolicy_horizontal = expanding
										margin_top = 10

										hbox = {
											layoutpolicy_horizontal = expanding
											spacing = 10
											margin = { 10 0 }

											widget = {
												size = { 40 40 }

												icon = {
													name = "progress_frame"
													size = { 100% 100% }
													texture = "gfx/interface/progressbars/progress_circle_frame.dds"
													alpha = 0.5
												}

												progresspie = {
													name = "progress"
													size = { 100% 100% }
													texture = "gfx/interface/progressbars/progress_circle.dds"
													framesize = { 248 248 }
													frame = "[SiegeWindow.GetPhaseTimerFrame]"
													value = "[Siege.GetPhaseProgress]"
													min = 0
													max = 1
												}
											}


											vbox = {
												layoutpolicy_horizontal = expanding

												text_single = {
													layoutpolicy_horizontal = expanding
													text = "SIEGE_EVENT"
													max_width = 105
													multiline = yes
													align = left|vcenter
												}

												text_single = {
													layoutpolicy_horizontal = expanding
													text = "[SiegeWindow.GetSiegePhaseLength]"
													default_format = "#high;glow_color:{0,0,0,1}"
													using = Font_Size_Big
													align = left|nobaseline
												}
											}
										}
									}

									hbox = {
										layoutpolicy_horizontal = expanding

										margin = { 10 0 }

										divider_light = {
											layoutpolicy_horizontal = expanding
											alpha = 0.5
										}
									}

									vbox = {
										layoutpolicy_horizontal = expanding
										layoutpolicy_vertical = expanding
										spacing = 5

										text_multi = {
											datacontext = "[SiegeWindow.GetSiege]"
											layoutpolicy_horizontal = expanding
											margin = { 10 0 }
											autoresize = yes
											max_width = 165
											text = "[SiegeWindow.GetActionHistoryTooltip('0')]"
										}

										widget = {
											layoutpolicy_horizontal = expanding
											layoutpolicy_vertical = expanding

											state = {
												name = "siege_event_flash"
												next = b
												trigger_on_create = yes

												alpha = 0
											}

											state = {
												name = b
												duration = 1
												using = Animation_Curve_Default

												alpha = 1
											}

											background = {
												name = "latest_action"
												visible = "[SiegeWindow.HasActionHistory('0')]"
												frame = "[SiegeWindow.GetActionHistoryFrame('0')]"
												texture = "gfx/interface/illustrations/siege/siege_actions.dds"
												framesize = { 360 200 }
												fittype = centercrop
												margin = { -5 0 }
												using = Mask_Rough_Edges
											}
										}
									}
								}
							}
						}
					}

					vbox = {
						layoutpolicy_horizontal = expanding
						layoutpolicy_vertical = expanding
						layoutstretchfactor_horizontal = 1

						state = {
							name = "siege_window_refresh"
							using = Animation_Refresh_FadeOut
						}

						state = {
							using = Animation_Refresh_FadeIn
						}

						hbox = {
							layoutpolicy_horizontal = expanding

							widget = {
								layoutpolicy_horizontal = expanding
								size = { 0 110 }
								tooltip = "[SiegeWindow.GetStarvationStateTooltip]"
								using = tooltip_ne

								state = {
									name = "siege_starvation_flash"
									next = b
									trigger_on_create = yes

									alpha = 0
								}

								state = {
									name = b
									duration = 1
									using = Animation_Curve_Default

									alpha = 1
								}

								proportional_icon = {
									size = { 100% 100% }
									frame = "[SiegeWindow.GetStarvationStateFrame]"
									texture = "gfx/interface/illustrations/siege/starvation_state.dds"
									framesize = { 340 420 }
									using = Mask_Rough_Edges

									modify_texture = {
										name = "flash"
										texture = "gfx/interface/colors/white.dds"
										blend_mode = colordodge
										alpha = 0
									}

									modify_texture = {
										name = "horizontal_wipe"
										texture = "gfx/interface/component_masks/mask_fade_horizontal_middle_solid.dds"
										blend_mode = mask
									}

									modify_texture = {
										name = "colordodge"
										texture = "gfx/interface/colors/white.dds"
										blend_mode = colordodge
										alpha = 0.2
									}

									state = {
										name = "siege_starvation_flash"
										next = b
										trigger_on_create = yes

										modify_texture = {
											name = "horizontal_wipe"
											translate_uv = { 1 0 }
										}
									}

									state = {
										name = b
										next = b
										duration = 0.8
										using = Animation_Curve_Default


										modify_texture = {
											name = "horizontal_wipe"
											translate_uv = { -1 0 }
										}
									}
								}
							}

							widget = {
								layoutpolicy_horizontal = expanding
								size = { 0 110 }
								tooltip = "[SiegeWindow.GetDiseaseStateTooltip]"
								using = tooltip_ne

								state = {
									name = "siege_disease_flash"
									next = b
									trigger_on_create = yes

									alpha = 0
								}

								state = {
									name = b
									duration = 1
									using = Animation_Curve_Default

									alpha = 1
								}

								proportional_icon = {
									size = { 100% 100% }
									frame = "[SiegeWindow.GetDiseaseStateFrame]"
									texture = "gfx/interface/illustrations/siege/disease_state.dds"
									framesize = { 340 420 }
									using = Mask_Rough_Edges

									modify_texture = {
										name = "flash"
										texture = "gfx/interface/colors/white.dds"
										blend_mode = colordodge
										alpha = 0
									}

									modify_texture = {
										name = "horizontal_wipe"
										texture = "gfx/interface/component_masks/mask_fade_horizontal_middle_solid.dds"
										blend_mode = mask
									}

									modify_texture = {
										name = "colordodge"
										texture = "gfx/interface/colors/white.dds"
										blend_mode = colordodge
										alpha = 0.2
									}

									state = {
										name = "siege_disease_flash"
										next = b
										trigger_on_create = yes

										modify_texture = {
											name = "horizontal_wipe"
											translate_uv = { 1 0 }
										}
									}

									state = {
										name = b
										next = b
										duration = 0.8
										using = Animation_Curve_Default


										modify_texture = {
											name = "horizontal_wipe"
											translate_uv = { -1 0 }
										}
									}
								}
							}
						}

						widget = {
							layoutpolicy_horizontal = expanding
							size = { 0 110 }

							widget = {
								#Only show tooltip on the top part, so it does not interfere with Assault Button tooltip
								size = { 100% 60 }
								tooltip = "[SiegeWindow.GetBreachStateTooltip]"
							}


							state = {
								name = "siege_breach_flash"
								next = b
								trigger_on_create = yes

								alpha = 0
							}

							state = {
								name = b
								duration = 1
								using = Animation_Curve_Default

								alpha = 1
							}

							proportional_icon = {
								size = { 100% 100% }
								frame = "[SiegeWindow.GetBreachStateFrame]"
								texture = "gfx/interface/illustrations/siege/breach_state.dds"
								framesize = { 700 440 }
								using = Mask_Rough_Edges

								modify_texture = {
									name = "flash"
									texture = "gfx/interface/colors/white.dds"
									blend_mode = colordodge
									alpha = 0
								}

								modify_texture = {
									name = "horizontal_wipe"
									texture = "gfx/interface/component_masks/mask_fade_horizontal_middle_solid.dds"
									blend_mode = mask
								}

								modify_texture = {
									name = "colordodge"
									texture = "gfx/interface/colors/white.dds"
									blend_mode = colordodge
									alpha = 0.2
								}

								state = {
									name = "siege_breach_flash"
									next = b
									trigger_on_create = yes

									modify_texture = {
										name = "horizontal_wipe"
										translate_uv = { 1 0 }
									}
								}

								state = {
									name = b
									next = b
									duration = 0.8
									using = Animation_Curve_Default


									modify_texture = {
										name = "horizontal_wipe"
										translate_uv = { -1 0 }
									}
								}
							}

							button_tertiary = {
								datacontext = "[SiegeWindow.GetSiege]"
								visible = "[And(SiegeWindow.GetSiege.IsPlayerInAttackerSide,Siege.ShowAssaultButton)]"
								parentanchor = bottom|hcenter
								position = { 0 -5 }
								size = { 150 40 }

								enabled = "[Siege.EnableAssaultButton]"
								tooltip = "[Siege.GetAssaultButtonTooltip]"
								onclick = "[SiegeWindow.StartStopAssault]"
								shortcut = siege_assault

								using = Animation_ShowHide_Standard

								state = {
									name = _mouse_enter
									on_start = "[PdxGuiTriggerAllAnimations('siege_assault_button_enter')]"
								}

								state = {
									name = _mouse_leave
									on_start = "[PdxGuiTriggerAllAnimations('siege_assault_button_leave')]"
								}

								state = {
									name = _mouse_press
									on_start = "[PdxGuiTriggerAllAnimations('siege_assault_button_press')]"
								}
								# state = {
								# 	name = _mouse_release
								# 	on_start = "[PdxGuiTriggerAllAnimations('siege_assault_button_release')]"
								# }

								widget = {
									size = { 100% 100% }
									scissor = yes
									alwaystransparent = yes

									button_normal = {
										parentanchor = bottom|hcenter
										alwaystransparent = yes
										size = { 150% 150% }
										position = { -20 0 }
										framesize = { 200 110 }
										texture = "gfx/interface/component_effects/fire_02.dds"
										alpha = 0

										effectname = "NoHighlight"

										using = Animation_Frames_100

										state = {
											name = "siege_assault_button_enter"
											duration = 0.1
											using = Animation_Curve_Default

											alpha = 0.2
										}

										state = {
											name = "siege_assault_button_leave"
											duration = 0.3
											using = Animation_Curve_Default

											alpha = 0
										}
									}
								}

								margin_widget = {
									size = { 100% 100% }
									scissor = yes

									icon = {
										parentanchor = center
										size = { 150 50 }
										texture = "gfx/interface/buttons/button_standard_aggressive.dds"
										spriteType = corneredstretched
										spriteborder = { 35 0 }
										texture_density = 2
										alpha = 0.3

										state = {
											name = "siege_assault_button_enter"
											duration = 0.1
											using = Animation_Curve_Default
											size = { 170 50 }

											alpha = 0.5
										}

										state = {
											name = "siege_assault_button_leave"
											duration = 0.2
											using = Animation_Curve_Default
											size = { 150 50 }

											alpha = 0.3
										}

										state = {
											name = "siege_assault_button_press"
											duration = 0.05
											using = Animation_Curve_Default
											size = { 150 50 }

											alpha = 0.3
										}
									}
								}

								widget = {
									visible = "[Siege.EnableAssaultButton]"
									size = { 100% 100% }

									state = {
										name = "siege_assault_button_enter"
										duration = 0.2
										using = Animation_Curve_Default
										alpha = 0
									}

									state = {
										name = "siege_assault_button_leave"
										duration = 0.3
										using = Animation_Curve_Default
										alpha = 1
									}

									icon = {
										position = { 0 5 }
										size = { 100% 100% }
										texture = "gfx/interface/component_masks/mask_fade_circle.dds"
										using = Color_Red
										alpha = 0

										state = {
											name = a
											next = b
											trigger_on_create = yes
											duration = 1.4
											using = Animation_Curve_Default
											alpha = 0.8
										}

										state = {
											name = b
											duration = 0.6
											using = Animation_Curve_Default
											alpha = 0
										}
									}
								}

								icon = {
									parentanchor = center
									alwaystransparent = yes
									texture = "gfx/interface/icons/icon_skills_martial.dds"
									scale = 0.8
									alpha = 0.5

									state = {
										name = "siege_assault_button_enter"
										duration = 0.05
										using = Animation_Curve_Default

										scale = 1.2
										alpha = 1
									}

									state = {
										name = "siege_assault_button_leave"
										duration = 0.15
										using = Animation_Curve_Default

										scale = 0.8
										alpha = 0.5
									}

									state = {
										name = "siege_assault_button_press"
										duration = 0
										using = Animation_Curve_Default

										scale = 0.8
										alpha = 0.5
									}
								}

								icon = {
									position = { 0 5 }
									size = { 100% 100% }
									texture = "gfx/interface/component_masks/mask_fade_circle.dds"
									color = { 0.1 0.1 0.1 1 }
									alpha = 0.2

									state = {
										name = "siege_assault_button_enter"
										duration = 0.05
										using = Animation_Curve_Default
										alpha = 0.8
									}

									state = {
										name = "siege_assault_button_leave"
										duration = 0.15
										using = Animation_Curve_Default
										alpha = 0.2
									}
								}

								text_single = {
									parentanchor = center
									text = "[SelectLocalization( Siege.IsAssaultInProgress, 'SW_STOP_ASSAULT', 'SW_START_ASSAULT' )]"
									using = Font_Size_Medium
									default_format = "#high;glow_color:{0,0,0,1}"
								}
							}

							vbox = {
								name = "time_and_assault"
								datacontext = "[SiegeWindow.GetSiege]"
								margin = { 10 10 }
								visible = "[SiegeWindow.GetSiege.IsAssaultInProgress]"

								text_label_center = {
									name = "assault_attacker"
									visible = "[SiegeWindow.GetSiege.IsPlayerInAttackerSide]"
									text = "SW_ASSAULTING_TEXT_ATTACKER"
									default_format = "#high"

									tooltip = "SIEGE_ASSAULT_TT_INFO_ACTIVE"
									align = center

									using = Animation_ShowHide_Standard
								}

								text_label_center = {
									name = "assault_not_attacker"
									visible = "[Not(SiegeWindow.GetSiege.IsPlayerInAttackerSide)]"
									text = "SW_ASSAULTING_TEXT_DEFENDER"
									default_format = "#N"

									tooltip = "SIEGE_ASSAULT_TT_INFO_ACTIVE"
									align = center

									using = Animation_ShowHide_Standard
								}
								expand = {}
							}
						}
					}
				}

				expand = {}
			}

			sounds_siege_window = {}
		}
	}
}